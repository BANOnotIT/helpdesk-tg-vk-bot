# core.py

В этом файле описаны 5 состояний для конечного автомата, в которых может находиться пользователь, ведя диалог с ботом.

#### Что такое конечный автомат (state machine - машина состояний)?
Это система, у которой есть конечный набор состояний, в которых она может находиться. Для каждого состояния описано при каких условиях в него можно попасть, и в какие состояние из него можно перейти.

В файле `/state_machine/__init__.py` описаны классы `State` (от него будут наследоваться все наши состояния) и `Machine` (в нем описаны функции для работы машины по переходу из состояния в состояние) его нужно изучить прежде чем продолжать разбираться в `core.py`.

Класс каждого состояния здесь наследуется от класса `State`
В функции `transition_rule` мы передаем сообщение пользователя и для каждого состояния описываем механизм перехода в другие состояния
В функции `leave` мы описываем что происходит, когда пользователь покидает его состояние 
В функции enter мы описываем что происходит, когда пользователь входит в определенное состояние
В функции stay мы описываем что происходит, если пользователь вынужден остаться в текущем состоянии


В классе BotStateMachine мы сопоставляем возможные состояния пользователя и классы, которые за них отвечают

В функции get_initial_state мы, на основе информации о пользователе, возвращаем класс состояния, на котором он остановился в диалоге, либо возвращаем базовое

При каждом запуске функции process_nmessage мы просто запускаем стейт машину с новым сообщением, чтобы внутри оно обработалось и состояние пользователя изменилось (или нет) 
